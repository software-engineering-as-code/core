write temporary first, then move, only if all files are written, the old ones can be overwritten